{% extends '@bolt/_partials/fields/_base.html.twig' %}
{% import '@bolt/_macro/_macro.html.twig' as macro %}

{% block field %}
    {% set labels = {
        'add_collection_item': 'collection.add_item'|trans({'%name%': field.definition.label}),
    } %}

    {# get the html for all collection field already in the database #}
    {% set existing_fields = []|json_encode %}
    {% if field.value is defined %}
        {% set existing_fields %}{{ macro.generate_collection_fields(field, field.value) }}{% endset %}
    {% endif %}

    {# get the html template for the collection fields defined in the field definition #}
    {% set templated_fields = "" %}
    {% if field.templates is defined %}
        {% set templated_fields %}{{  macro.generate_collection_fields(field, field.templates) }}{% endset %}
    {% endif %}

    <editor-collection
            :existing-fields='{{ existing_fields }}'
            :templates='{{ templated_fields }}'
            :labels='{{ labels | json_encode }}'
    ></editor-collection>

{% endblock %}